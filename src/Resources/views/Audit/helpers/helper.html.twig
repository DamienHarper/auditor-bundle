{% macro dump(value, separator) %}
    {%- import _self as helper -%}
    {%- if value.label is defined -%}
        {{- value.label -}}
    {%- elseif value is iterable -%}
        {%- for k, v in value -%}
            {{- k }}: {{ helper.dump(v) }}{{ separator|default('<br/>')|raw -}}
        {%- endfor -%}
    {%- elseif value is same as(true) -%}
        true
    {%- elseif value is same as(false) -%}
        false
    {%- else -%}
        {{- value -}}
    {%- endif -%}
{% endmacro dump %}

{% macro namespaceToParam(entity) %}
{{- entity|replace({'\\': '-'}) -}}
{% endmacro namespaceToParam %}

{% macro type_badge(type) %}
    {%- if type == 'insert' -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400">INSERT</span>
    {%- elseif type == 'update' -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400">UPDATE</span>
    {%- elseif type == 'remove' -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400">REMOVE</span>
    {%- elseif type == 'associate' -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400">LINK</span>
    {%- elseif type == 'dissociate' -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-rose-50 text-rose-600 dark:bg-rose-900/20 dark:text-rose-300">UNLINK</span>
    {%- else -%}
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-400">{{ type|upper }}</span>
    {%- endif -%}
{% endmacro type_badge %}

{% macro activity_graph(data, days) %}
    <div class="mt-3 pt-3 border-t border-slate-100 dark:border-slate-800">
        <div class="flex items-end gap-0.5 h-8">
            {% set hasActivity = data|filter(v => v > 0)|length > 0 %}
            {% for value in data %}
                {% if hasActivity %}
                    <div class="flex-1 bg-indigo-400 dark:bg-indigo-500 rounded-sm transition-all hover:bg-indigo-500 dark:hover:bg-indigo-400"
                         style="height: {{ value > 0 ? (value < 10 ? 10 : value) : 2 }}%"
                         title="{{ value }}%"></div>
                {% else %}
                    <div class="flex-1 bg-slate-200 dark:bg-slate-700 rounded-sm" style="height: 15%"></div>
                {% endif %}
            {% endfor %}
        </div>
        <div class="text-[10px] text-slate-400 dark:text-slate-500 mt-1">
            {% if hasActivity %}
                {{ 'audit.activity_graph.period'|trans({'%days%': days}, 'auditor') }}
            {% else %}
                {{ 'audit.activity_graph.no_activity'|trans(domain='auditor') }}
            {% endif %}
        </div>
    </div>
{% endmacro activity_graph %}
